<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nodejs and Express</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<script>
    $(document).ready(function () {
        var isRunning = false; //Default is stopped
        //Start 
        function start() {
            // console.log("is running")
            $('#coinbaseFetchButton').html('Stop');
            $('#buttonInfo').html("Click the button to stop pushing Crypto data to DataBox every 30 seconds")
        }
        //Stops    
        function stop() {
            //console.log("stopped running")
            $('#coinbaseFetchButton').html('Start');
            $('#buttonInfo').html("Click the button to push Crypto data to DataBox every 30 seconds")
        }

        $('#coinbaseFetchButton').click(function () {

            $('#animationSpan').toggleClass('loaderActive');
            $('#coinbaseFetchButton').toggleClass("stop");
            isRunning ? stop() : start();
            isRunning = !isRunning;     //

            isRunning ? value = 'start' : value = 'stop';
            //send request to start trigger or end trigger
            fetch(`http://localhost:3000/${value}`)
                .then(function (response) {
                    return response.json();
                })
                .then(json => console.log(json))
        });

    });
</script>


<body>
    <header class="flexMiddle">
        <h1>DataBox Integration</h1>
    </header>
    <div class="main">
        <h2 id="buttonInfo">Click the button to push Crypto data to DataBox every 30 seconds</h2>
        <!--  Add loading animation-->
     <div id="animationSpan" class="loader">
        <span></span>
        <span></span>
        <span></span>
        <span></span>
      </div>
        
        <button class="mainButton" id="coinbaseFetchButton"> Start</button>
     
        <div id="output"></div>
        <button class="mainButton" id="showSendDataButton"> Show services</button>
        <script src="ejs.min.js"></script>
        <script src="ejs.min.js">
 $('#showSendDataButton').click(function () {
          
            fetch(`http://localhost:3000/getsentdata`)
                .then(function (response) {
                    //console.log(response)
                    return response.json();
                })
                .then(function(res){
                       var a =res.response.dataRecords;
                        console.log(a);
                        html=ejs.render()

                })
        });
/*
          let people = ['geddy', 'neil', 'alex'],
              html = ejs.render('<%= people.join(", "); %>', {people: people});
          // With jQuery:
          $('#output').html(html);
          // Vanilla JS:
          document.getElementById('output').innerHTML = html;
  */
  </script>

    </div>
    <footer class="flexMiddle">
        <h2>Made by <a href="https://github.com/JanHuntersi">Jan Sernec</a></h2>
    </footer>
</body>

</html>